<td data-sort="<%=coinship.try(:market_cap_rank_prediction)%>">
  <% if current_account && current_account.id == @account.id %>
    <a href="javascript:;" onclick="$(this).hide().next().show().find('input').focus()">#<%=coinship.try(:market_cap_rank_prediction)%></a>
    <% form_tag "/coins/#{coin.id}/market_cap_rank_prediction", :style => 'display: none' do %>

      <div class="input-group flex-nowrap">
        <div class="input-group-prepend">
          <span class="input-group-text">#</span>
        </div>
        <%= number_field_tag :p, :value => coinship.try(:market_cap_rank_prediction), :class => 'form-control', :style => 'width: 5em;', :onblur => '$(this.form).submit()', :onfocus => "var val = this.value; this.value = ''; this.value = val;" %>
      </div>
    <% end %>
  <% else %>
    <% if coinship.try(:market_cap_rank_prediction) %>
      <span data-toggle="tooltip" title="Market cap rank prediction: #<%=coinship.try(:market_cap_rank_prediction)%>">
        #<%=coinship.try(:market_cap_rank_prediction)%>
      </span>
    <% end %>
  <% end %>
</td>
<td data-sort="<%=coinship.try(:market_cap_rank_prediction_conviction)%>">
  <% if current_account && current_account.id == @account.id %>
    <a href="javascript:;" onclick="$(this).hide().next().show().find('input').focus()"><%=coinship.try(:market_cap_rank_prediction_conviction) || '&hellip;'%></a>
    <% form_tag "/coins/#{coin.id}/market_cap_rank_prediction_conviction", :style => 'display: none' do %>
      <%= number_field_tag :p, :value => coinship.try(:market_cap_rank_prediction_conviction), :class => 'form-control', :style => 'width: 5em;', :onblur => '$(this.form).submit()', :onfocus => "var val = this.value; this.value = ''; this.value = val;" %>
    <% end %>
  <% else %>
    <% if coinship.try(:market_cap_rank_prediction_conviction) %>
      <span data-toggle="tooltip" title="Market cap rank prediction conviction: <%=coinship.try(:market_cap_rank_prediction_conviction)%>">
        <%=coinship.try(:market_cap_rank_prediction_conviction)%>
      </span>
    <% end %>
  <% end %>
</td>
<td data-sort="<%=coinship.try(:market_cap_change_prediction)%>">
  <% if coinship.try(:market_cap_change_prediction); p = coinship.market_cap_change_prediction.round %>
    <a href="javascript:;" style="text-decoration: none; font-family: sans-serif" data-toggle="tooltip" title="<%=p%>x"><% p.times do %><i class="fa fa-square"></i> <% end %></a>
  <% end %>
</td>
<td class="holding" data-sort="<%= (!coinship || coinship.holding < 1e-3 ? 0 : coinship.holding) * @account.price_factor  %>">
  <% if coinship %>
    <% if current_account && current_account.id == @account.id %>
      <a class="text-dark" href="javascript:;" onclick="$(this).hide().next().show().find('input').focus()">
        <div class="p">
          <i data-toggle="tooltip" class="fas fa-pencil-alt"></i>
        </div>
      </a>
      <% form_tag "/coins/#{coin.id}/units_elsewhere", :style => 'display: none' do %>
        <% if coinship.units %>
          <%=coinship.units%> +
        <% end %>
        <%= text_field_tag :units_elsewhere, :placeholder => 'Elsewhere', :value => coinship.try(:units_elsewhere), :class => 'form-control', :style => 'width: 100%;', :onblur => '$(this.form).submit()', :onfocus => "var val = this.value; this.value = ''; this.value = val;" %>
      <% end %>
    <% else %>
      <div class="p"></div>
    <% end %>
  <% end %>
</td>
